Assignment - 12 % python3 Decoder_only_GPT2_style_transformer.py
using device: mps
Total Parameters: 124,439,808
Trainable Parameters: 124,439,808
Model Size: 474.70 MB

Size by component:
transformer: 474.70 MB
loaded 338025 tokens
1 epoch = 165 batches
Training for 20000 steps
step 0, loss: 10.9502, avg_loss: 10.9502, best_loss: 10.9502, lr: 2.00e-05, time/batch: 0.000s
step 100, loss: 7.3906, avg_loss: 8.3566, best_loss: 7.3123, lr: 2.11e-05, time/batch: 0.253s
step 200, loss: 6.1753, avg_loss: 6.8555, best_loss: 6.1532, lr: 2.45e-05, time/batch: 0.270s
step 300, loss: 5.9569, avg_loss: 6.2094, best_loss: 5.6177, lr: 2.99e-05, time/batch: 0.284s
step 400, loss: 5.5256, avg_loss: 5.8287, best_loss: 5.3965, lr: 3.73e-05, time/batch: 0.285s
step 500, loss: 5.7069, avg_loss: 5.6113, best_loss: 4.8180, lr: 4.65e-05, time/batch: 0.284s
step 600, loss: 5.5649, avg_loss: 5.3132, best_loss: 4.6987, lr: 5.72e-05, time/batch: 0.390s
step 700, loss: 5.1711, avg_loss: 5.1089, best_loss: 4.2885, lr: 6.93e-05, time/batch: 0.680s
step 800, loss: 4.3251, avg_loss: 4.9638, best_loss: 4.2482, lr: 8.24e-05, time/batch: 0.492s
step 900, loss: 5.0213, avg_loss: 4.7389, best_loss: 3.9379, lr: 9.61e-05, time/batch: 0.436s
step 1000, loss: 4.3302, avg_loss: 4.6289, best_loss: 3.6702, lr: 1.10e-04, time/batch: 0.418s
step 1100, loss: 4.6830, avg_loss: 4.4508, best_loss: 3.6702, lr: 1.24e-04, time/batch: 0.396s
step 1200, loss: 4.3765, avg_loss: 4.3032, best_loss: 3.4492, lr: 1.38e-04, time/batch: 0.387s
step 1300, loss: 4.2446, avg_loss: 4.2775, best_loss: 3.4492, lr: 1.51e-04, time/batch: 0.386s
step 1400, loss: 3.8800, avg_loss: 4.0641, best_loss: 3.2410, lr: 1.63e-04, time/batch: 0.401s
step 1500, loss: 3.7004, avg_loss: 3.9946, best_loss: 3.0554, lr: 1.74e-04, time/batch: 0.392s
step 1600, loss: 4.2758, avg_loss: 3.9018, best_loss: 3.0554, lr: 1.83e-04, time/batch: 0.392s
step 1700, loss: 3.8317, avg_loss: 3.7076, best_loss: 2.8623, lr: 1.90e-04, time/batch: 0.399s
step 1800, loss: 3.4979, avg_loss: 3.6547, best_loss: 2.8623, lr: 1.96e-04, time/batch: 0.399s
step 1900, loss: 3.3440, avg_loss: 3.4729, best_loss: 2.6924, lr: 1.99e-04, time/batch: 0.399s
step 2000, loss: 3.3396, avg_loss: 3.3584, best_loss: 2.5123, lr: 2.00e-04, time/batch: 0.400s
step 2100, loss: 3.4327, avg_loss: 3.2191, best_loss: 2.5123, lr: 2.00e-04, time/batch: 0.401s
step 2200, loss: 3.1999, avg_loss: 3.0309, best_loss: 2.3588, lr: 2.00e-04, time/batch: 0.406s
step 2300, loss: 2.5306, avg_loss: 2.8855, best_loss: 2.3542, lr: 2.00e-04, time/batch: 0.371s
step 2400, loss: 2.4819, avg_loss: 2.7043, best_loss: 2.1018, lr: 2.00e-04, time/batch: 0.376s
step 2500, loss: 2.2164, avg_loss: 2.5656, best_loss: 1.8638, lr: 2.00e-04, time/batch: 0.366s
step 2600, loss: 2.5642, avg_loss: 2.3902, best_loss: 1.8638, lr: 1.99e-04, time/batch: 0.371s
step 2700, loss: 1.9574, avg_loss: 2.1937, best_loss: 1.6151, lr: 1.99e-04, time/batch: 0.372s
step 2800, loss: 2.2590, avg_loss: 2.0341, best_loss: 1.3983, lr: 1.99e-04, time/batch: 0.349s
step 2900, loss: 1.8801, avg_loss: 1.8711, best_loss: 1.3746, lr: 1.99e-04, time/batch: 0.346s
step 3000, loss: 1.6372, avg_loss: 1.7541, best_loss: 1.1942, lr: 1.98e-04, time/batch: 0.349s
step 3100, loss: 1.3899, avg_loss: 1.5685, best_loss: 1.1642, lr: 1.98e-04, time/batch: 0.350s
step 3200, loss: 1.4524, avg_loss: 1.4191, best_loss: 0.9916, lr: 1.98e-04, time/batch: 0.349s
step 3300, loss: 1.6236, avg_loss: 1.3050, best_loss: 0.8499, lr: 1.97e-04, time/batch: 0.345s
step 3400, loss: 0.8917, avg_loss: 1.1371, best_loss: 0.7908, lr: 1.97e-04, time/batch: 0.372s
step 3500, loss: 0.8239, avg_loss: 1.0750, best_loss: 0.6883, lr: 1.97e-04, time/batch: 0.397s
step 3600, loss: 0.8416, avg_loss: 0.9311, best_loss: 0.6009, lr: 1.96e-04, time/batch: 0.364s
step 3700, loss: 0.6804, avg_loss: 0.8270, best_loss: 0.5226, lr: 1.96e-04, time/batch: 0.357s
step 3800, loss: 0.9998, avg_loss: 0.7511, best_loss: 0.4586, lr: 1.95e-04, time/batch: 0.340s
step 3900, loss: 0.7241, avg_loss: 0.6125, best_loss: 0.3827, lr: 1.95e-04, time/batch: 0.340s
step 4000, loss: 0.5161, avg_loss: 0.6005, best_loss: 0.3769, lr: 1.94e-04, time/batch: 0.362s
step 4100, loss: 0.4876, avg_loss: 0.5046, best_loss: 0.3139, lr: 1.93e-04, time/batch: 0.347s
step 4200, loss: 0.3954, avg_loss: 0.4499, best_loss: 0.2634, lr: 1.93e-04, time/batch: 0.362s
step 4300, loss: 0.3480, avg_loss: 0.4232, best_loss: 0.2634, lr: 1.92e-04, time/batch: 0.360s
step 4400, loss: 0.3834, avg_loss: 0.3403, best_loss: 0.2488, lr: 1.91e-04, time/batch: 0.358s
step 4500, loss: 0.3117, avg_loss: 0.3380, best_loss: 0.2243, lr: 1.91e-04, time/batch: 0.347s
step 4600, loss: 0.3666, avg_loss: 0.2967, best_loss: 0.1965, lr: 1.90e-04, time/batch: 0.347s
step 4700, loss: 0.2116, avg_loss: 0.2577, best_loss: 0.1678, lr: 1.89e-04, time/batch: 0.349s
step 4800, loss: 0.2463, avg_loss: 0.2555, best_loss: 0.1677, lr: 1.88e-04, time/batch: 0.355s
step 4900, loss: 0.2584, avg_loss: 0.2176, best_loss: 0.1437, lr: 1.87e-04, time/batch: 0.347s
step 5000, loss: 0.1908, avg_loss: 0.2145, best_loss: 0.1437, lr: 1.87e-04, time/batch: 0.424s
step 5100, loss: 0.1696, avg_loss: 0.2007, best_loss: 0.1410, lr: 1.86e-04, time/batch: 0.363s
step 5200, loss: 0.1805, avg_loss: 0.1812, best_loss: 0.1338, lr: 1.85e-04, time/batch: 0.350s
step 5300, loss: 0.1874, avg_loss: 0.1785, best_loss: 0.1114, lr: 1.84e-04, time/batch: 0.353s
step 5400, loss: 0.1917, avg_loss: 0.1626, best_loss: 0.1060, lr: 1.83e-04, time/batch: 0.341s
step 5500, loss: 0.1590, avg_loss: 0.1615, best_loss: 0.1060, lr: 1.82e-04, time/batch: 0.342s
step 5600, loss: 0.1561, avg_loss: 0.1511, best_loss: 0.1011, lr: 1.81e-04, time/batch: 0.367s
step 5700, loss: 0.1226, avg_loss: 0.1423, best_loss: 0.1011, lr: 1.80e-04, time/batch: 0.360s
step 5800, loss: 0.1156, avg_loss: 0.1433, best_loss: 0.1011, lr: 1.79e-04, time/batch: 0.350s
step 5900, loss: 0.1410, avg_loss: 0.1349, best_loss: 0.0890, lr: 1.78e-04, time/batch: 0.361s
step 6000, loss: 0.1268, avg_loss: 0.1290, best_loss: 0.0890, lr: 1.77e-04, time/batch: 0.358s
step 6100, loss: 0.1301, avg_loss: 0.1242, best_loss: 0.0860, lr: 1.75e-04, time/batch: 0.367s